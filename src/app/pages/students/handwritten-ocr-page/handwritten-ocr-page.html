<ng-container>
  <div class="w-full min-h-screen p-6 font-sans text-[#474747]">
    <div class="mb-6 flex flex-col gap-2">
      <h1 class="text-2xl md:text-3xl font-bold text-[#203864]">Handwritten Submission OCR</h1>
      <p class="text-sm text-[#7A7A7A]">Upload a handwritten JPG/PNG/PDF and view the extracted text.</p>
    </div>

    <div class="bg-white border-[3px] border-[#E7E7E7] rounded-3xl p-6">
      <div class="flex flex-col gap-4">
        <div>
          <input
            type="file"
            accept=".jpg,.jpeg,.png,.pdf,image/jpeg,image/png,application/pdf"
            (change)="onFileSelected($event)"
            class="block w-full text-sm"
          />
          <p class="text-xs text-[#7A7A7A] mt-2">Max size: 10MB. Supported: JPG, PNG, PDF.</p>
        </div>

        <div class="flex flex-row gap-3">
          <button type="button" class="btn-primary" (click)="uploadAndOcr()" [disabled]="isLoading || !selectedFile">
            Upload & OCR
          </button>

          @if (uploadProgressPercent !== null) {
            <div class="flex items-center">
              <p class="text-sm text-[#7A7A7A]">{{ uploadProgressPercent }}%</p>
            </div>
          }
        </div>
      </div>
    </div>

    @if (fileUrl) {
      <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="bg-white border-[3px] border-[#E7E7E7] rounded-3xl p-6">
          <h2 class="text-lg font-bold text-[#203864] mb-4">Uploaded File</h2>

          @if (isPdf) {
            <div class="w-full bg-[#F3F3F3] p-4 rounded-2xl flex flex-col gap-3">
              <p class="text-sm text-gray-700 font-medium">PDF uploaded successfully.</p>
              <a class="btn-info w-fit" [href]="fileUrl" target="_blank" rel="noopener">Open PDF</a>
            </div>
          } @else {
            <img [src]="fileUrl" class="w-full rounded-2xl object-contain bg-[#F3F3F3]" alt="uploaded" />
          }
        </div>

        <div class="bg-white border-[3px] border-[#E7E7E7] rounded-3xl p-6">
          <h2 class="text-lg font-bold text-[#203864] mb-4">Extracted Text</h2>

          @if (ocrError) {
            <div class="w-full bg-white border border-red-200 rounded-xl p-4">
              <p class="text-sm text-red-500 font-medium">{{ ocrError }}</p>
            </div>
          }

          @if (!ocrError && ocrText) {
            <div class="w-full bg-white border border-gray-200 rounded-xl p-4">
              <div class="max-h-[520px] overflow-y-auto">
                <pre class="text-sm leading-relaxed text-gray-700 whitespace-pre-wrap font-sans">{{ ocrText }}</pre>
              </div>
            </div>
          }

          @if (!ocrError && !ocrText) {
            <div class="w-full bg-white border border-gray-200 rounded-xl p-4">
              <p class="text-sm text-gray-600 font-medium">No text extracted.</p>
            </div>
          }
        </div>
      </div>
    }
  </div>
</ng-container>
